var action=function(){"use strict";var e={eventMe:function(t){var n=t;return n.emitterId=Math.ceil(1e4*Math.random()),n.eventStore={},n.emit=function(t,n,o){var i,c,r=this,a="undefined"!=typeof o&&o;if(i=a?r.eventStore[t]:e.eventStore[t],"undefined"!=typeof i)for(c=0;c<i.length;c++)"undefined"!=typeof i[c].scope?i[c].call.apply(i[c].scope,[n,r.emitterId]):i[c].call(n,r.emitterId),i[c].once&&(a?r.silenceLocal(t,i[c].call,!0):r.silence(t,i[c].call,!0))},n.emitLocal=function(e,t){var n=this;n.emit(e,t,!0)},n.listen=function(t,n,o,i,c){var r,a,l,f=this,s=!0,d=t,u=n,p=o,v=c,y=i;if("object"==typeof t&&(d=t.eventName,u=t.handler,p=t.scope,y=t.once,v=t.local),a="undefined"!=typeof v&&v?f.eventStore[t]:e.eventStore[t],l="undefined"!=typeof v&&v?f:e,"undefined"!=typeof a){for(r=0;r<a.length;r++)if(a[r].call===u&&a[r].once===!1){s=!1;break}s&&"undefined"!=typeof o?a.push({once:!1,call:u,scope:p}):s&&a.push({once:!1,call:u})}else l.eventStore[d]=[],l.eventStore[d].push("undefined"!=typeof o?{once:!1,call:u,scope:p}:{once:!1,call:u})},n.listenLocal=function(e,t,n,o){var i=this;"object"==typeof e?(e.local=!0,i.listen(e)):i.listen({eventName:e,handler:t,scope:n,once:o,local:!0})},n.listenOnce=function(t,n,o,i){var c,r,a,l=this,f=!0,s=t,d=n,u=o,p=i;if("object"==typeof t&&(s=t.eventName,d=t.handler,u=t.scope,p=t.local),"undefined"!=typeof p&&p?(r=l.eventStore[s],a=l):(r=e.eventStore[s],a=e),"undefined"!=typeof r){for(c=0;c<r.length;c++)if(r[c].call===d&&r[c].once===!0){f=!1;break}f&&r.push({once:!0,call:d,scope:u})}else a.eventStore[t]=[],a.eventStore[t].push({once:!0,call:d,scope:u})},n.listenOnceLocal=function(e,t,n){var o=this;"object"==typeof e?(e.local=!0,o.listenLocal(e)):o.listenLocal({eventName:e,handler:t,scope:n,local:!0})},n.silence=function(t,n,o,i,c){var r,a,l=this,f=!1,s=t,d=n,u=o,p=i,v=c;if("object"==typeof t&&(s=t.eventName,d=t.handler,u=t.once,p=t.scope,v=t.local),a="undefined"!=typeof v&&v?l:e,"undefined"!=typeof a.eventStore[s])for(r=0;r<a.eventStore[s].length;r++){if(f=!1,"undefined"==typeof d){a.eventStore[s]=[];break}f="undefined"!=typeof p?"boolean"==typeof u?d===a.eventStore[s][r].call&&p===a.eventStore[s][r].scope&&u===a.eventStore[s][r].once:d===a.eventStore[s][r].call&&p===a.eventStore[s][r].scope:"boolean"==typeof u?d===a.eventStore[s][r].call&&a.eventStore[s][r].once===u:d===a.eventStore[s][r].call,f&&a.eventStore[s].splice(r,1)}},n.silenceLocal=function(e,t,n,o){var i=this;"object"==typeof e?(e.local=!0,i.silence(e)):i.silence({eventName:e,handler:t,once:n,scope:o,local:!0})},n.requiredEvent=function(e,t,n,o){var i,c=this;c._fireMultiple="undefined"!=typeof o?o:!1,"undefined"==typeof c.stateEvents&&(c.stateEvents={}),"undefined"==typeof c._triggeredStateReady&&(c._triggeredStateReady=!1),c.stateEvents[e]=!1,i=c.stateUpdate(e,c.stateEvents),c.listen(e,i,c),c.listen(e,t,n)},n.stateUpdate=function(e,t){var n=e,o=t,i=this;return function(){var e,t=!0;if("undefined"!=typeof o[n]){o[n]=!0;for(e in o)t=t&&o[e];t&&(!i._triggeredStateReady||i._fireMultiple)&&(setTimeout(i.stateReady,100),i._triggeredStateReady=!0)}}},n.stateReady=function(){console.log("ready!")},n.listen("system:trace",function(e){var t=this;t.emitterId===e&&t.emit("system:addTraced",t)},n),"function"==typeof n.init&&n.init.apply(n),n},modelMe:function(t){var n=this,o=n.eventMe({}),i={},c=[];return o.get=function(e){return i[e]},o.set=function(e,t){var n,o=this;if("object"==typeof e)for(n in e)e.hasOwnProperty(n)&&("destroy"!==n&&"fetch"!==n&&"save"!==n&&"function"!=typeof e[n]?(i[n]=e[n],o.emitLocal("attribute:changed",n)):o[n]=e[n]);else"destroy"!==e&&"fetch"!==e&&"save"!==e?(i[e]=t,o.emitLocal("attribute:changed",e)):o[e]=t},o.flatten=function(){return i},o.fetch=function(){var t=this,n=t.get("url");if("undefined"==typeof n)throw new e.Error("http","No URL defined")},o.save=function(){var t=this,n=t.get("url");if("undefined"==typeof n)throw new e.Error("http","No URL defined");c=[]},o.getChanges=function(){return c},o.clear=function(){i={}},o.destroy=function(){var e,t=this;setTimeout(function(){},0);for(e in t);},o.set(t),o.listenLocal("attribute:changed",function(e){c.push(e)},this),"function"==typeof o.init&&o.init.apply(o),o},trace:function(t){e.traced=e.modelMe({stack:[],emitterId:t}),e.traced.listen("system:addTraced",function(e){var t=this;t.get("stack").push(e)},e.traced),e.events.emit("system:trace",t)},Error:function(e,t){return{type:e,message:t}},eventStore:{}};return e=e.eventMe(e),window.onerror=function(e){console.log("Error occured"),console.warn(e)},e}(this);